var E=Object.defineProperty,L=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var T=(a,t,o)=>t in a?E(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,h=(a,t)=>{for(var o in t||(t={}))_.call(t,o)&&T(a,o,t[o]);if(R)for(var o of R(t))F.call(t,o)&&T(a,o,t[o]);return a},p=(a,t)=>L(a,O(t));import{r as i,j as S,u as C,L as I,N as U,a as $,B,R as j,b as v,c as P,d as D}from"./vendor.f01e59db.js";const H=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}};H();const x=i.exports.createContext(),e=S.exports.jsx,s=S.exports.jsxs,G=S.exports.Fragment,M=()=>{const a=i.exports.useContext(x),{login:t,autenticado:o}=a,c=C();i.exports.useEffect(()=>{o&&c("/")},[o]);const[r,n]=i.exports.useState({email:"",password:""}),d=f=>{n(p(h({},r),{[f.target.name]:f.target.value}))};return e("div",{className:"container mt-5 mx-auto",children:s("form",{onSubmit:f=>{f.preventDefault(),t(r)},children:[s("div",{className:"mb-3",children:[e("label",{className:"form-label",children:"E-mail"}),e("input",{type:"email",className:"form-control","aria-describedby":"emailHelp",name:"email",onChange:d})]}),s("div",{className:"mb-3",children:[e("label",{className:"form-label",children:"Contrasena"}),e("input",{type:"password",className:"form-control",name:"password",onChange:d})]}),e("div",{className:"d-flex flex-row-reverse",children:e("button",{type:"submit",className:"btn btn-primary",children:"Conectar"})})]})})},k=()=>{const a=i.exports.useContext(x),{cerrarSesion:t}=a;return e("nav",{className:"navbar navbar-dark bg-primary",children:s("div",{className:"container-fluid",children:[e(I,{className:"navbar-brand",to:"/",children:"Bienvenido Dr Felipe Castillo"}),e("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:e("span",{className:"navbar-toggler-icon"})}),e("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:s("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[e("li",{className:"nav-item",children:e(I,{to:"/",className:"nav-link",children:"Inicio"})}),e("li",{className:"nav-item",children:e(I,{to:"/crear-cita",className:"nav-link",children:"Crear Cita"})}),e("li",{className:"nav-item",children:e("button",{className:"btn btn-danger",onClick:()=>{console.log("cerrando sesion"),t()},children:"Cerrar Sesion"})})]})})]})})},y=i.exports.createContext(),z=({cita:a})=>{const t=i.exports.useContext(y),{obtenerCita:o}=t,c=C(),r=async()=>{await o(a._id),c(`/cita/${a._id}`)};return e("div",{className:"card my-2 border-primary",children:s("div",{className:"card-body",children:[s("h5",{className:"card-title",children:["Hospital: ",a?a.hospital:""]}),s("p",{className:"card-text",children:["Hora : ",a?a.hora:""," hrs"]}),s("p",{className:"card-text",children:["Fecha: ",a?`${a.fecha}`.substring(0,10):""]}),s("p",{className:"card-text",children:["Paciente: ",a?a.nombre:""," "]}),e("div",{className:"d-flex justify-content-end",children:e("a",{onClick:r,className:"btn btn-primary",children:"Ver"})})]})})},q=()=>{const a=i.exports.useContext(y),{citas:t,obtenerCitas:o,citasFecha:c}=a,r=n=>{c(n.target.value)};return i.exports.useEffect(async()=>{await o()},[]),s(G,{children:[e(k,{}),s("div",{className:"container mx-auto mt-5 row",children:[e("input",{type:"date",className:"form-control",placeholder:"Fecha",onChange:r}),t.length?t.map(n=>e(z,{cita:n},n._id)):e("p",{className:" text-center p-5 disponibles",children:"No hay citas"})]})]})},K=()=>{const a=i.exports.useContext(y),{eliminarCita:t,cita:o,actualizarCita:c}=a,r=C(),[n,d]=i.exports.useState({}),l=N=>{d(p(h({},n),{[N.target.name]:N.target.value}))},f=N=>{N.preventDefault(),d(p(h({},n),{fecha:new Date(n.fecha).toLocaleDateString()})),c(n),r("/")};return i.exports.useEffect(()=>{o&&d(o)},[]),s(i.exports.Fragment,{children:[e(k,{}),s("form",{className:"row g-3 container mx-auto mt-3",onSubmit:f,children:[s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Nombre del Paciente"}),e("input",{type:"text",name:"nombre",className:"form-control",value:n.nombre,onChange:l})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Telefono de Contacto"}),e("input",{type:"number",className:"form-control",name:"numero",value:n.numero,onChange:l})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Telfono de Contacto 2 (opcional)"}),e("input",{type:"number",name:"numero2",className:"form-control",value:n.numero2,onChange:l})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Correo (opcional)"}),e("input",{type:"email",className:"form-control",name:"email",value:n.email,onChange:l})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Fecha"}),e("input",{type:"date",name:"fecha",className:"form-control",value:`${n.fecha}`.substring(0,10),onChange:l})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Hora"}),e("input",{type:"time",className:"form-control",name:"hora",value:n.hora,onChange:l})]}),s("div",{className:"",children:[e("label",{className:"form-label",children:"Hospital"}),e("input",{type:"text",className:"form-control",name:"hospital",value:n.hospital,onChange:l})]}),s("div",{className:"form-group",children:[e("label",{className:"center",children:"Informacion Adicional (opcional)"}),e("textarea",{className:"form-control",rows:"4",name:"informacion",value:n.informacion,onChange:l})]}),s("div",{className:"col-12 d-flex flex-row-reverse",children:[e("button",{type:"submit",className:"btn btn-primary",children:"Guardar"}),e("button",{type:"button",className:"btn btn-danger mx-2",onClick:()=>{t(n._id),r("/")},children:"Eliminar"})]})]})]})},V=()=>{const a=i.exports.useContext(y),{crearCita:t}=a,[o,c]=i.exports.useState({}),r=C(),n=l=>{c(p(h({},o),{[l.target.name]:l.target.value}))},d=l=>{l.preventDefault(),t(o),r("/")};return s(i.exports.Fragment,{children:[e(k,{}),s("form",{className:"row g-3 container mx-auto mt-3",onSubmit:d,children:[s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Nombre del Paciente"}),e("input",{type:"text",name:"nombre",className:"form-control",onChange:n})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Telefono de Contacto"}),e("input",{type:"number",className:"form-control",name:"numero",onChange:n})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Telfono de Contacto 2 (opcional)"}),e("input",{type:"number",name:"numero2",className:"form-control",onChange:n})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Correo (opcional)"}),e("input",{type:"email",className:"form-control",name:"email",onChange:n})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Fecha"}),e("input",{type:"date",name:"fecha",className:"form-control",onChange:n})]}),s("div",{className:"col-md-6",children:[e("label",{className:"form-label",children:"Hora"}),e("input",{type:"time",className:"form-control",name:"hora",onChange:n})]}),s("div",{className:"",children:[e("label",{className:"form-label",children:"Hospital"}),e("input",{type:"text",className:"form-control",name:"hospital",onChange:n})]}),s("div",{className:"form-group",children:[e("label",{className:"center",children:"Informacion Adicional (opcional)"}),e("textarea",{className:"form-control",rows:"4",name:"informacion",onChange:n})]}),e("div",{className:"col-12 d-flex flex-row-reverse",children:e("button",{type:"submit",className:"btn btn-primary",children:"Guardar"})})]})]})},w=({children:a})=>{const t=i.exports.useContext(x),{autenticado:o,obtenerUsuario:c,usuario:r}=t;return i.exports.useEffect(async()=>{r||await c()},[o]),o?a:e(U,{to:"/login"})},b=$.create({baseURL:window.location.origin}),A=a=>{a?b.defaults.headers.common["x-token"]=a:delete b.defaults.headers.common["x-token"]};var Z=(a,t)=>{switch(t.type){case"OBTENER_CITAS":return p(h({},a),{citas:t.payload,cita:null});case"OBTENER_CITA":return p(h({},a),{cita:t.payload});case"CREAR_CITA":return p(h({},a),{citas:[...a.citas,t.payload],cita:null});case"ELIMINAR_CITA":return p(h({},a),{citas:a.citas.filter(o=>o.id!==t.payload)});case"ACTUALIZAR_CITA":return p(h({},a),{citas:a.citas.map(o=>o.id===t.payload.id?t.payload:o),cita:null});case"CITA_NULL":return p(h({},a),{cita:null});default:return a}};const J=a=>{const t={citas:[],cita:{}},[o,c]=i.exports.useReducer(Z,t),r=async()=>{try{const u=(await b.get("/citas")).data;c({type:"OBTENER_CITAS",payload:u})}catch(m){console.log(m.response)}},n=async m=>{try{const g=(await b.get(`/citas/fecha/${m}`)).data;c({type:"OBTENER_CITAS",payload:g})}catch(u){console.log(u.response)}},d=async m=>{try{const g=(await b.get(`/citas/${m}`)).data;return console.log(g),c({type:"OBTENER_CITA",payload:g}),g}catch(u){console.log(u.response)}},l=async m=>{try{await b.post("/citas",m),r()}catch(u){console.log(u.response)}},f=async m=>{try{await b.delete(`/citas/${m}`),c({type:"ELIMINAR_CITA",payload:m}),r()}catch(u){console.log(u)}},N=async m=>{try{const u=await b.put(`/citas/${m._id}`,m);r()}catch(u){console.log(u)}};return e(y.Provider,{value:{citas:o.citas,cita:o.cita,fecha:o.fecha,obtenerCitas:r,obtenerCita:d,crearCita:l,eliminarCita:f,actualizarCita:N,citasFecha:n},children:a.children})};var Q=(a,t)=>{switch(t.type){case"LOGIN":return localStorage.setItem("x-token",t.payload.token),p(h({},a),{usuario:t.payload.usuario,autenticado:!0,token:t.payload.token});case"LOGOUT":return p(h({},a),{usuario:null,autenticado:!1,token:null});case"USUARIO":return localStorage.setItem("x-token",t.payload.token),p(h({},a),{usuario:t.payload,autenticado:!0,token:t.payload.token});default:return a}};const W=a=>{const t={token:localStorage.getItem("x-token"),autenticado:null,usuario:null,cargando:!0},[o,c]=i.exports.useReducer(Q,t),r=async l=>{try{const f=await b.post("/auth/singin",l),{token:N,usuario:m}=f.data;c({type:"LOGIN",payload:{token:N,usuario:m}}),A(N)}catch(f){console.log(f)}},n=()=>{delete b.defaults.headers.common["user-token"],localStorage.removeItem("x-token"),c({type:"LOGOUT"})},d=async()=>{try{A(localStorage.getItem("x-token"));const l=await b.get("/auth/usuario");c({type:"USUARIO",payload:l.data}),localStorage.setItem("x-token",l.data.token),A(l.data.token)}catch(l){console.log(l.response)}};return e(x.Provider,{value:{usuario:o.usuario,cargando:o.cargando,autenticado:o.autenticado,token:o.token,login:r,cerrarSesion:n,obtenerUsuario:d},children:a.children})};function X(){return e(W,{children:e(J,{children:e(B,{children:s(j,{children:[e(v,{path:"/login",element:e(M,{})}),e(v,{path:"/",element:e(w,{children:e(q,{})})}),e(v,{path:"/crear-cita",element:e(w,{children:e(V,{})})}),e(v,{path:"/cita/:id",element:e(w,{children:e(K,{})})})]})})})})}P.render(e(D.StrictMode,{children:e(X,{})}),document.getElementById("root"));
